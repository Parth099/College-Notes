{
  "cells": [
    {
      "cell_type": "code",
      "execution_count": 1,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 386
        },
        "id": "HNgWFTGXRVw5",
        "outputId": "9075da7f-662b-48da-886c-45ce7d8fee5a"
      },
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "<IPython.core.display.HTML object>"
            ],
            "text/html": [
              "\n",
              "     <input type=\"file\" id=\"files-baa0b616-0924-40a9-8db5-b03b0d76c9df\" name=\"files[]\" multiple disabled\n",
              "        style=\"border:none\" />\n",
              "     <output id=\"result-baa0b616-0924-40a9-8db5-b03b0d76c9df\">\n",
              "      Upload widget is only available when the cell has been executed in the\n",
              "      current browser session. Please rerun this cell to enable.\n",
              "      </output>\n",
              "      <script>// Copyright 2017 Google LLC\n",
              "//\n",
              "// Licensed under the Apache License, Version 2.0 (the \"License\");\n",
              "// you may not use this file except in compliance with the License.\n",
              "// You may obtain a copy of the License at\n",
              "//\n",
              "//      http://www.apache.org/licenses/LICENSE-2.0\n",
              "//\n",
              "// Unless required by applicable law or agreed to in writing, software\n",
              "// distributed under the License is distributed on an \"AS IS\" BASIS,\n",
              "// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n",
              "// See the License for the specific language governing permissions and\n",
              "// limitations under the License.\n",
              "\n",
              "/**\n",
              " * @fileoverview Helpers for google.colab Python module.\n",
              " */\n",
              "(function(scope) {\n",
              "function span(text, styleAttributes = {}) {\n",
              "  const element = document.createElement('span');\n",
              "  element.textContent = text;\n",
              "  for (const key of Object.keys(styleAttributes)) {\n",
              "    element.style[key] = styleAttributes[key];\n",
              "  }\n",
              "  return element;\n",
              "}\n",
              "\n",
              "// Max number of bytes which will be uploaded at a time.\n",
              "const MAX_PAYLOAD_SIZE = 100 * 1024;\n",
              "\n",
              "function _uploadFiles(inputId, outputId) {\n",
              "  const steps = uploadFilesStep(inputId, outputId);\n",
              "  const outputElement = document.getElementById(outputId);\n",
              "  // Cache steps on the outputElement to make it available for the next call\n",
              "  // to uploadFilesContinue from Python.\n",
              "  outputElement.steps = steps;\n",
              "\n",
              "  return _uploadFilesContinue(outputId);\n",
              "}\n",
              "\n",
              "// This is roughly an async generator (not supported in the browser yet),\n",
              "// where there are multiple asynchronous steps and the Python side is going\n",
              "// to poll for completion of each step.\n",
              "// This uses a Promise to block the python side on completion of each step,\n",
              "// then passes the result of the previous step as the input to the next step.\n",
              "function _uploadFilesContinue(outputId) {\n",
              "  const outputElement = document.getElementById(outputId);\n",
              "  const steps = outputElement.steps;\n",
              "\n",
              "  const next = steps.next(outputElement.lastPromiseValue);\n",
              "  return Promise.resolve(next.value.promise).then((value) => {\n",
              "    // Cache the last promise value to make it available to the next\n",
              "    // step of the generator.\n",
              "    outputElement.lastPromiseValue = value;\n",
              "    return next.value.response;\n",
              "  });\n",
              "}\n",
              "\n",
              "/**\n",
              " * Generator function which is called between each async step of the upload\n",
              " * process.\n",
              " * @param {string} inputId Element ID of the input file picker element.\n",
              " * @param {string} outputId Element ID of the output display.\n",
              " * @return {!Iterable<!Object>} Iterable of next steps.\n",
              " */\n",
              "function* uploadFilesStep(inputId, outputId) {\n",
              "  const inputElement = document.getElementById(inputId);\n",
              "  inputElement.disabled = false;\n",
              "\n",
              "  const outputElement = document.getElementById(outputId);\n",
              "  outputElement.innerHTML = '';\n",
              "\n",
              "  const pickedPromise = new Promise((resolve) => {\n",
              "    inputElement.addEventListener('change', (e) => {\n",
              "      resolve(e.target.files);\n",
              "    });\n",
              "  });\n",
              "\n",
              "  const cancel = document.createElement('button');\n",
              "  inputElement.parentElement.appendChild(cancel);\n",
              "  cancel.textContent = 'Cancel upload';\n",
              "  const cancelPromise = new Promise((resolve) => {\n",
              "    cancel.onclick = () => {\n",
              "      resolve(null);\n",
              "    };\n",
              "  });\n",
              "\n",
              "  // Wait for the user to pick the files.\n",
              "  const files = yield {\n",
              "    promise: Promise.race([pickedPromise, cancelPromise]),\n",
              "    response: {\n",
              "      action: 'starting',\n",
              "    }\n",
              "  };\n",
              "\n",
              "  cancel.remove();\n",
              "\n",
              "  // Disable the input element since further picks are not allowed.\n",
              "  inputElement.disabled = true;\n",
              "\n",
              "  if (!files) {\n",
              "    return {\n",
              "      response: {\n",
              "        action: 'complete',\n",
              "      }\n",
              "    };\n",
              "  }\n",
              "\n",
              "  for (const file of files) {\n",
              "    const li = document.createElement('li');\n",
              "    li.append(span(file.name, {fontWeight: 'bold'}));\n",
              "    li.append(span(\n",
              "        `(${file.type || 'n/a'}) - ${file.size} bytes, ` +\n",
              "        `last modified: ${\n",
              "            file.lastModifiedDate ? file.lastModifiedDate.toLocaleDateString() :\n",
              "                                    'n/a'} - `));\n",
              "    const percent = span('0% done');\n",
              "    li.appendChild(percent);\n",
              "\n",
              "    outputElement.appendChild(li);\n",
              "\n",
              "    const fileDataPromise = new Promise((resolve) => {\n",
              "      const reader = new FileReader();\n",
              "      reader.onload = (e) => {\n",
              "        resolve(e.target.result);\n",
              "      };\n",
              "      reader.readAsArrayBuffer(file);\n",
              "    });\n",
              "    // Wait for the data to be ready.\n",
              "    let fileData = yield {\n",
              "      promise: fileDataPromise,\n",
              "      response: {\n",
              "        action: 'continue',\n",
              "      }\n",
              "    };\n",
              "\n",
              "    // Use a chunked sending to avoid message size limits. See b/62115660.\n",
              "    let position = 0;\n",
              "    do {\n",
              "      const length = Math.min(fileData.byteLength - position, MAX_PAYLOAD_SIZE);\n",
              "      const chunk = new Uint8Array(fileData, position, length);\n",
              "      position += length;\n",
              "\n",
              "      const base64 = btoa(String.fromCharCode.apply(null, chunk));\n",
              "      yield {\n",
              "        response: {\n",
              "          action: 'append',\n",
              "          file: file.name,\n",
              "          data: base64,\n",
              "        },\n",
              "      };\n",
              "\n",
              "      let percentDone = fileData.byteLength === 0 ?\n",
              "          100 :\n",
              "          Math.round((position / fileData.byteLength) * 100);\n",
              "      percent.textContent = `${percentDone}% done`;\n",
              "\n",
              "    } while (position < fileData.byteLength);\n",
              "  }\n",
              "\n",
              "  // All done.\n",
              "  yield {\n",
              "    response: {\n",
              "      action: 'complete',\n",
              "    }\n",
              "  };\n",
              "}\n",
              "\n",
              "scope.google = scope.google || {};\n",
              "scope.google.colab = scope.google.colab || {};\n",
              "scope.google.colab._files = {\n",
              "  _uploadFiles,\n",
              "  _uploadFilesContinue,\n",
              "};\n",
              "})(self);\n",
              "</script> "
            ]
          },
          "metadata": {}
        },
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "mv: cannot stat './kaggle.json': No such file or directory\n",
            "chmod: cannot access '/root/.kaggle/kaggle.json': No such file or directory\n",
            "Traceback (most recent call last):\n",
            "  File \"/usr/local/bin/kaggle\", line 5, in <module>\n",
            "    from kaggle.cli import main\n",
            "  File \"/usr/local/lib/python3.9/dist-packages/kaggle/__init__.py\", line 23, in <module>\n",
            "    api.authenticate()\n",
            "  File \"/usr/local/lib/python3.9/dist-packages/kaggle/api/kaggle_api_extended.py\", line 164, in authenticate\n",
            "    raise IOError('Could not find {}. Make sure it\\'s located in'\n",
            "OSError: Could not find kaggle.json. Make sure it's located in /root/.kaggle. Or use the environment method.\n",
            "Traceback (most recent call last):\n",
            "  File \"/usr/local/bin/kaggle\", line 5, in <module>\n",
            "    from kaggle.cli import main\n",
            "  File \"/usr/local/lib/python3.9/dist-packages/kaggle/__init__.py\", line 23, in <module>\n",
            "    api.authenticate()\n",
            "  File \"/usr/local/lib/python3.9/dist-packages/kaggle/api/kaggle_api_extended.py\", line 164, in authenticate\n",
            "    raise IOError('Could not find {}. Make sure it\\'s located in'\n",
            "OSError: Could not find kaggle.json. Make sure it's located in /root/.kaggle. Or use the environment method.\n",
            "Archive:  ieee-fraud-detection.zip\n",
            "replace ./dataset/sample_submission.csv? [y]es, [n]o, [A]ll, [N]one, [r]ename: N\n"
          ]
        }
      ],
      "source": [
        "#! DO NOT RUN MORE THAN ONCE -> once data is loaded do not run this \n",
        "#! This will need to be ran if dataset is not loaded\n",
        "#! github save path: CompSci/CIS3715 - Principles of Data Science/Labs/Final Project/kaggle-CCFraud.ipynb\n",
        "# download kaggle dataset\n",
        "! pip install -q kaggle\n",
        "\n",
        "# create upload file prompt\n",
        "from google.colab import files\n",
        "files.upload()\n",
        "\n",
        "# store data at ~\n",
        "! rm -r ~/.kaggle\n",
        "! mkdir ~/.kaggle\n",
        "! mv ./kaggle.json ~/.kaggle/\n",
        "\n",
        "# give u=rw privs\n",
        "! chmod 600 ~/.kaggle/kaggle.json \n",
        "\n",
        "# check if we downloaded the data\n",
        "! kaggle competitions download -c ieee-fraud-detection\n",
        "! kaggle datasets list | grep \"ieee\"\n",
        "\n",
        "# extract the data\n",
        "! mkdir -p dataset\n",
        "! unzip -d ./dataset/ ieee-fraud-detection.zip"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "GtCN_ZoHAkzG"
      },
      "source": [
        "# Exploratory Data Analysis"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "2VStIekSFbfI"
      },
      "source": [
        "## Dataset Information"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 2,
      "metadata": {
        "id": "h8tl_S7IFeaj"
      },
      "outputs": [],
      "source": [
        "import pandas as pd\n",
        "import matplotlib.pyplot as plt\n",
        "\n",
        "# Link to Kaggle Dataset: https://www.kaggle.com/competitions/ieee-fraud-detection/\n",
        "# read in dataset\n",
        "train_transaction = pd.read_csv(f'./dataset/train_transaction.csv')"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 3,
      "metadata": {
        "id": "KQTpkAUnFjHp",
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 411
        },
        "outputId": "da9a96ee-18d2-4e7d-f5d5-28fcb1d616f8"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Shape of the Training Dataset: (590540, 394)\n"
          ]
        },
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "       TransactionID        isFraud  TransactionDT  TransactionAmt  \\\n",
              "count   5.905400e+05  590540.000000   5.905400e+05   590540.000000   \n",
              "mean    3.282270e+06       0.034990   7.372311e+06      135.027176   \n",
              "std     1.704744e+05       0.183755   4.617224e+06      239.162522   \n",
              "min     2.987000e+06       0.000000   8.640000e+04        0.251000   \n",
              "25%     3.134635e+06       0.000000   3.027058e+06       43.321000   \n",
              "50%     3.282270e+06       0.000000   7.306528e+06       68.769000   \n",
              "75%     3.429904e+06       0.000000   1.124662e+07      125.000000   \n",
              "max     3.577539e+06       1.000000   1.581113e+07    31937.391000   \n",
              "\n",
              "               card1          card2          card3          card5  \\\n",
              "count  590540.000000  581607.000000  588975.000000  586281.000000   \n",
              "mean     9898.734658     362.555488     153.194925     199.278897   \n",
              "std      4901.170153     157.793246      11.336444      41.244453   \n",
              "min      1000.000000     100.000000     100.000000     100.000000   \n",
              "25%      6019.000000     214.000000     150.000000     166.000000   \n",
              "50%      9678.000000     361.000000     150.000000     226.000000   \n",
              "75%     14184.000000     512.000000     150.000000     226.000000   \n",
              "max     18396.000000     600.000000     231.000000     237.000000   \n",
              "\n",
              "               addr1          addr2  ...          V330           V331  \\\n",
              "count  524834.000000  524834.000000  ...  82351.000000   82351.000000   \n",
              "mean      290.733794      86.800630  ...      0.775874     721.741883   \n",
              "std       101.741072       2.690623  ...      4.727971    6217.223583   \n",
              "min       100.000000      10.000000  ...      0.000000       0.000000   \n",
              "25%       204.000000      87.000000  ...      0.000000       0.000000   \n",
              "50%       299.000000      87.000000  ...      0.000000       0.000000   \n",
              "75%       330.000000      87.000000  ...      0.000000       0.000000   \n",
              "max       540.000000     102.000000  ...     55.000000  160000.000000   \n",
              "\n",
              "                V332           V333          V334         V335          V336  \\\n",
              "count   82351.000000   82351.000000  82351.000000  82351.00000  82351.000000   \n",
              "mean     1375.783644    1014.622782      9.807015     59.16455     28.530903   \n",
              "std     11169.275702    7955.735482    243.861391    387.62948    274.576920   \n",
              "min         0.000000       0.000000      0.000000      0.00000      0.000000   \n",
              "25%         0.000000       0.000000      0.000000      0.00000      0.000000   \n",
              "50%         0.000000       0.000000      0.000000      0.00000      0.000000   \n",
              "75%        25.000000       0.000000      0.000000      0.00000      0.000000   \n",
              "max    160000.000000  160000.000000  55125.000000  55125.00000  55125.000000   \n",
              "\n",
              "                V337           V338           V339  \n",
              "count   82351.000000   82351.000000   82351.000000  \n",
              "mean       55.352422     151.160542     100.700882  \n",
              "std       668.486833    1095.034387     814.946722  \n",
              "min         0.000000       0.000000       0.000000  \n",
              "25%         0.000000       0.000000       0.000000  \n",
              "50%         0.000000       0.000000       0.000000  \n",
              "75%         0.000000       0.000000       0.000000  \n",
              "max    104060.000000  104060.000000  104060.000000  \n",
              "\n",
              "[8 rows x 380 columns]"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-b0dbee10-f7ae-4416-bffc-82827801543a\">\n",
              "    <div class=\"colab-df-container\">\n",
              "      <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>TransactionID</th>\n",
              "      <th>isFraud</th>\n",
              "      <th>TransactionDT</th>\n",
              "      <th>TransactionAmt</th>\n",
              "      <th>card1</th>\n",
              "      <th>card2</th>\n",
              "      <th>card3</th>\n",
              "      <th>card5</th>\n",
              "      <th>addr1</th>\n",
              "      <th>addr2</th>\n",
              "      <th>...</th>\n",
              "      <th>V330</th>\n",
              "      <th>V331</th>\n",
              "      <th>V332</th>\n",
              "      <th>V333</th>\n",
              "      <th>V334</th>\n",
              "      <th>V335</th>\n",
              "      <th>V336</th>\n",
              "      <th>V337</th>\n",
              "      <th>V338</th>\n",
              "      <th>V339</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>count</th>\n",
              "      <td>5.905400e+05</td>\n",
              "      <td>590540.000000</td>\n",
              "      <td>5.905400e+05</td>\n",
              "      <td>590540.000000</td>\n",
              "      <td>590540.000000</td>\n",
              "      <td>581607.000000</td>\n",
              "      <td>588975.000000</td>\n",
              "      <td>586281.000000</td>\n",
              "      <td>524834.000000</td>\n",
              "      <td>524834.000000</td>\n",
              "      <td>...</td>\n",
              "      <td>82351.000000</td>\n",
              "      <td>82351.000000</td>\n",
              "      <td>82351.000000</td>\n",
              "      <td>82351.000000</td>\n",
              "      <td>82351.000000</td>\n",
              "      <td>82351.00000</td>\n",
              "      <td>82351.000000</td>\n",
              "      <td>82351.000000</td>\n",
              "      <td>82351.000000</td>\n",
              "      <td>82351.000000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>mean</th>\n",
              "      <td>3.282270e+06</td>\n",
              "      <td>0.034990</td>\n",
              "      <td>7.372311e+06</td>\n",
              "      <td>135.027176</td>\n",
              "      <td>9898.734658</td>\n",
              "      <td>362.555488</td>\n",
              "      <td>153.194925</td>\n",
              "      <td>199.278897</td>\n",
              "      <td>290.733794</td>\n",
              "      <td>86.800630</td>\n",
              "      <td>...</td>\n",
              "      <td>0.775874</td>\n",
              "      <td>721.741883</td>\n",
              "      <td>1375.783644</td>\n",
              "      <td>1014.622782</td>\n",
              "      <td>9.807015</td>\n",
              "      <td>59.16455</td>\n",
              "      <td>28.530903</td>\n",
              "      <td>55.352422</td>\n",
              "      <td>151.160542</td>\n",
              "      <td>100.700882</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>std</th>\n",
              "      <td>1.704744e+05</td>\n",
              "      <td>0.183755</td>\n",
              "      <td>4.617224e+06</td>\n",
              "      <td>239.162522</td>\n",
              "      <td>4901.170153</td>\n",
              "      <td>157.793246</td>\n",
              "      <td>11.336444</td>\n",
              "      <td>41.244453</td>\n",
              "      <td>101.741072</td>\n",
              "      <td>2.690623</td>\n",
              "      <td>...</td>\n",
              "      <td>4.727971</td>\n",
              "      <td>6217.223583</td>\n",
              "      <td>11169.275702</td>\n",
              "      <td>7955.735482</td>\n",
              "      <td>243.861391</td>\n",
              "      <td>387.62948</td>\n",
              "      <td>274.576920</td>\n",
              "      <td>668.486833</td>\n",
              "      <td>1095.034387</td>\n",
              "      <td>814.946722</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>min</th>\n",
              "      <td>2.987000e+06</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>8.640000e+04</td>\n",
              "      <td>0.251000</td>\n",
              "      <td>1000.000000</td>\n",
              "      <td>100.000000</td>\n",
              "      <td>100.000000</td>\n",
              "      <td>100.000000</td>\n",
              "      <td>100.000000</td>\n",
              "      <td>10.000000</td>\n",
              "      <td>...</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.00000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>25%</th>\n",
              "      <td>3.134635e+06</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>3.027058e+06</td>\n",
              "      <td>43.321000</td>\n",
              "      <td>6019.000000</td>\n",
              "      <td>214.000000</td>\n",
              "      <td>150.000000</td>\n",
              "      <td>166.000000</td>\n",
              "      <td>204.000000</td>\n",
              "      <td>87.000000</td>\n",
              "      <td>...</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.00000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>50%</th>\n",
              "      <td>3.282270e+06</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>7.306528e+06</td>\n",
              "      <td>68.769000</td>\n",
              "      <td>9678.000000</td>\n",
              "      <td>361.000000</td>\n",
              "      <td>150.000000</td>\n",
              "      <td>226.000000</td>\n",
              "      <td>299.000000</td>\n",
              "      <td>87.000000</td>\n",
              "      <td>...</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.00000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>75%</th>\n",
              "      <td>3.429904e+06</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>1.124662e+07</td>\n",
              "      <td>125.000000</td>\n",
              "      <td>14184.000000</td>\n",
              "      <td>512.000000</td>\n",
              "      <td>150.000000</td>\n",
              "      <td>226.000000</td>\n",
              "      <td>330.000000</td>\n",
              "      <td>87.000000</td>\n",
              "      <td>...</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>25.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.00000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>max</th>\n",
              "      <td>3.577539e+06</td>\n",
              "      <td>1.000000</td>\n",
              "      <td>1.581113e+07</td>\n",
              "      <td>31937.391000</td>\n",
              "      <td>18396.000000</td>\n",
              "      <td>600.000000</td>\n",
              "      <td>231.000000</td>\n",
              "      <td>237.000000</td>\n",
              "      <td>540.000000</td>\n",
              "      <td>102.000000</td>\n",
              "      <td>...</td>\n",
              "      <td>55.000000</td>\n",
              "      <td>160000.000000</td>\n",
              "      <td>160000.000000</td>\n",
              "      <td>160000.000000</td>\n",
              "      <td>55125.000000</td>\n",
              "      <td>55125.00000</td>\n",
              "      <td>55125.000000</td>\n",
              "      <td>104060.000000</td>\n",
              "      <td>104060.000000</td>\n",
              "      <td>104060.000000</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>8 rows Ã— 380 columns</p>\n",
              "</div>\n",
              "      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-b0dbee10-f7ae-4416-bffc-82827801543a')\"\n",
              "              title=\"Convert this dataframe to an interactive table.\"\n",
              "              style=\"display:none;\">\n",
              "        \n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n",
              "    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n",
              "  </svg>\n",
              "      </button>\n",
              "      \n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      flex-wrap:wrap;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "      <script>\n",
              "        const buttonEl =\n",
              "          document.querySelector('#df-b0dbee10-f7ae-4416-bffc-82827801543a button.colab-df-convert');\n",
              "        buttonEl.style.display =\n",
              "          google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "        async function convertToInteractive(key) {\n",
              "          const element = document.querySelector('#df-b0dbee10-f7ae-4416-bffc-82827801543a');\n",
              "          const dataTable =\n",
              "            await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                     [key], {});\n",
              "          if (!dataTable) return;\n",
              "\n",
              "          const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "            + ' to learn more about interactive tables.';\n",
              "          element.innerHTML = '';\n",
              "          dataTable['output_type'] = 'display_data';\n",
              "          await google.colab.output.renderOutput(dataTable, element);\n",
              "          const docLink = document.createElement('div');\n",
              "          docLink.innerHTML = docLinkHtml;\n",
              "          element.appendChild(docLink);\n",
              "        }\n",
              "      </script>\n",
              "    </div>\n",
              "  </div>\n",
              "  "
            ]
          },
          "metadata": {},
          "execution_count": 3
        }
      ],
      "source": [
        "print(f'Shape of the Training Dataset: {train_transaction.shape}')\n",
        "\n",
        "train_transaction.head()\n",
        "train_transaction.describe()"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "xRDx5Nh9AyqX"
      },
      "source": [
        "## Dataset Balance"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 4,
      "metadata": {
        "id": "Tzawsp2NCGG_",
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 452
        },
        "outputId": "2811d26c-0c9a-46e6-8485-49a0f12e61f3"
      },
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "<Figure size 640x480 with 1 Axes>"
            ],
            "image/png": "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aJA6d+6sl19+WZGRkc3e3FfN5/PJ5/O1dBsAAOArck63z8fExKh79+7avXu3EhMTVVVVpdLS0oCakpISJSYmSpISExPr3blVt91Qjd/vV2RkpOLi4hQSEnLKmhPXaKgXAACAcwpCn3/+ud5//3116NBBqampCgsL07Jly7z5oqIi7du3T+np6ZKk9PR0bd26NeDurqVLl8rv96tXr15ezYlr1NXUrREeHq7U1NSAmtraWi1btsyraUwvAAAATbo347777rOVK1fanj17bM2aNZaRkWFxcXF26NAhMzObMmWKJScn2/Lly23Tpk2Wnp5u6enp3uOPHz9uffr0sWHDhllhYaEtXrzY4uPjLScnx6v54IMPLCoqymbMmGE7d+60uXPnWkhIiC1evNirycvLM5/PZ7m5ubZjxw6bPHmyxcTEBNyN1lAvjdGUq87PRkvflcNgXMgDAM5WUz6/m3S4GTt2rHXo0MHCw8PtkksusbFjx9ru3bu9+YqKCrvrrrssNjbWoqKi7MYbb7SDBw8GrLF3714bMWKERUZGWlxcnN13331WXV0dULNixQrr37+/hYeHW7du3Wz+/Pn1ennqqacsOTnZwsPDLS0tzdatWxcw35heGkIQYjBabgDA2WrK53eQmVnLnpO6cJWXlys6OlplZWXy+/3Nvn5QULMvCVw0ODIBOFtN+fzmb40BAABnEYQAAICzCEIAAMBZBCEAAOAsghAAAHAWQQgAADiLIAQAAJxFEAIAAM4iCAEAAGcRhAAAgLMIQgAAwFkEIQAA4CyCEAAAcBZBCAAAOIsgBAAAnEUQAgAAziIIAQAAZxGEAACAswhCAADAWQQhAADgLIIQAABwFkEIAAA4iyAEAACcRRACAADOIggBAABnEYQAAICzCEIAAMBZBCEAAOAsghAAAHAWQQgAADiLIAQAAJxFEAIAAM4iCAEAAGcRhAAAgLMIQgAAwFkEIQAA4CyCEAAAcBZBCAAAOIsgBAAAnEUQAgAAziIIAQAAZxGEAACAswhCAADAWQQhAADgLIIQAABwFkEIAAA4iyAEAACcRRACAADOIggBAABnEYQAAICzzikIzZkzR0FBQZo2bZq379ixY8rOzla7du3UunVrjRkzRiUlJQGP27dvn7KyshQVFaX27dtrxowZOn78eEDNypUrNWDAAPl8PqWkpCg3N7fe88+d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PC7+3yOE82/ixIkaM2aMPvroI3Xs2DFgbv78+Ro4cKCuuOKKJq8bHx/fXC02SlFRUcCv3G/fvr337yNHjuiaa67R0KFD9cYbbyg+Pl67du1SbGyspC//rs2oUaMUFhamv//97/L7/frNb36jjIwM7dixwwspt912m0pLS/WPf/xDcXFxevHFF3XzzTdr06ZNuvLKK3X11Vfr4MGDAX397Gc/07JlyzRw4EBJ0k9+8hNNmTIloOb666/XN77xjfPycwFOZfjw4Zo/f37AvlO9Z6uqqhQeHv5VtXVW3n33XdXW1urZZ59VSkqKtm3bpjvvvFNffPGFfv3rX0v68m+UDRs2TBkZGXrmmWe0detWTZgwQTExMd7/sFVVVemGG25Q+/bt9corr+iSSy7Rhx9+GPCnmho6lkhS9+7d9fvf/17dunVTRUWFfvvb32rYsGHavXv3V35cdIIB56i6utoSEhLsv/7rvwL2Hz161Fq3bm3z5s2zTz/91H7wgx9YUlKSRUZGWp8+fezFF18MqL/uuuts6tSp3nbnzp3tt7/9rbf93nvv2eDBg83n89nll19ub775pkmyhQsXnlP/K1asMEl25MiR09Y88MADdu211552vqioyCTZtm3bvH01NTUWHx9vf/jDH7x9rVq1sj//+c8Bj23btm1AzYmqqqosPj7efvGLX5z2uQsLC02SrV69+rQ1QHMaP368jRw58pRz1113nWVnZ9vUqVOtXbt2NmTIENuzZ49JsnfeecerO3LkiEmyFStWmJnZ8ePHbcKECdalSxeLiIiw7t272xNPPBGw9vHjx+3ee++16Ohoa9u2rc2YMcNuu+220/ZyLh599FHr2rWrt/30009bbGysVVZWevseeOAB69Gjh7c9b94869atm1VVVZ123YaOJadSVlZmkuytt95q0uPQOHw1hnMWGhqq2267Tbm5ubITfj/nggULVFNTo1tuuUXHjh1Tamqq/vnPf2rbtm2aPHmyxo0bpw0bNjTqOWprazV69GiFh4dr/fr1euaZZ/TAAw806+vo37+/OnTooBtuuEFr1qwJmPvHP/6hgQMH6qabblL79u115ZVX6g9/+IM3X1lZKUmKiIjw9gUHB8vn8+ntt9/29l199dV66aWXdPjwYdXW1iovL0/Hjh3TkCFDTtnTP/7xD3322Wdn/JMwf/zjH9W9e3cNHjz4bF420Oyef/55hYeHa82aNXrmmWca9Zja2lp17NhRCxYs0I4dOzRz5kz99Kc/1csvv+zVPP7448rNzdWf/vQnvf322zp8+LAWLlx4Xl5DWVmZ2rZt623n5+frm9/8ZsDZrczMTBUVFenIkSOSvny/pqenKzs7WwkJCerTp4/++7//WzU1Nd5jGjqWnKyqqkrPPfecoqOj1a9fv/PwSsEZITSLnTt3BvzfnZnZ4MGD7Yc//OFpH5OVlWX33Xeft32mM0JLliyx0NBQ+/jjj735N954o1nOCL377rv2zDPP2KZNm2zNmjV2xx13WGhoqBUUFHg1Pp/PfD6f5eTk2ObNm+3ZZ5+1iIgIy83NNbMvz9wkJyfbTTfdZIcPH7bKykqbM2eOSbJhw4Z56xw5csSGDRtmkiw0NNT8fr8tWbLktL2NGDHCRowYcdr5iooKi42NtV/96lfn9DMAmmL8+PEWEhJirVq18sb3v/99M/vyfXzllVcG1DfmjNCpZGdn25gxY7ztDh062KOPPuptV1dXW8eOHZv9jNCuXbvM7/fbc8895+274YYbbPLkyQF127dvN0m2Y8cOMzPr0aOH+Xw+mzBhgm3atMny8vKsbdu29vDDD3uPaehYUue1116zVq1aWVBQkCUlJdmGDRua9TXi/xCE0GyuvvpqGzdunJl9eSDRSae9f/GLX1ifPn0sNjbWWrVqZaGhoXbTTTd5jz9TEHriiScCTlObmZWWlp4xCP31r38NOFA35aujb37zmwEhLiwszNLT0wNq7rnnHrvqqqu87U2bNlm/fv1MkoWEhFhmZqaNGDHChg8f7tXcfffdlpaWZm+99ZYVFhbaww8/bNHR0bZly5Z6Pezfv9+Cg4PtlVdeOW2fL774ooWGhlpxcXGjXxtwrsaPH28ZGRm2a9cubxw4cMDMvnwfT5o0KaC+sUHo97//vQ0YMMDi4uKsVatWFhYWZt/4xjfM7P/e76tWrQpYe9SoUWcMQiceA370ox81+No++ugju/TSS23ixIkB+xsThC677DLr1KmTHT9+3Kt5/PHHLTEx0dtuzLHEzOzzzz+3Xbt2WX5+vveVYUlJSYP9o+m4WBrNZuLEibrnnns0d+5czZ8/X5deeqmuu+46SdJjjz2mJ598Uk888YT69u2rVq1aadq0afXuymhO3/ve9zRo0CBv+5JLLmn0Y9PS0gK+0urQoYN69eoVUHP55ZcH3PGVmpqqwsJClZWVqaqqSvHx8Ro0aJB3kfP777+v3//+99q2bZt69+4tSerXr5/+9a9/ae7cufW+Qpg/f77atWun733ve6ft849//KO+853v8EeE8ZVr1aqVUlJSTjt3ouDgL6/CsBO+Oq+urg6oycvL009+8hM9/vjjSk9PV5s2bfTYY4+d891ShYWF3r9PvBniVA4cOKChQ4fq6quv1nPPPRcwl5iYqJKSkoB9dduJiYmSvjxOhIWFKSQkxKu5/PLLVVxc7F003phjifR/P9+UlBRdddVVuuyyy/Q///M/ysnJadwLR6NxjRCazc0336zg4GC9+OKL+vOf/6wJEyYoKChIkrRmzRqNHDlSP/zhD9WvXz9169ZN7733XqPXvvzyy7V///6AO6rWrVt3xse0adPGO5CkpKQoMjKy0c9XWFioDh06eNvXXHONioqKAmree+89de7cud5jo6OjvTtBNm3apJEjR0qS/vOf/0j6vw+FOiEhIaqtrQ3YZ2aaP3++brvtNoWFhZ2yxz179mjFihWaOHFio18X0BLq7nQ68f17YkCRvjxGXH311brrrrt05ZVXKiUlRe+//743Hx0drQ4dOgQEo+PHj6ugoOCMz33iMeDEO0FP9vHHH2vIkCFKTU3V/Pnz671P09PTtXr16oAAt3TpUvXo0cO74+uaa67R7t27A97P7733njp06OBdW9SUY8mJamtrvWsR0cxa+pQULi4TJ0602NhYCwkJCbie595777VOnTrZmjVrbMeOHTZp0iTz+/0Bp7TP9NVYTU2N9erVy2644QYrLCy01atXW2pqarNcI/Tb3/7WXn31Vdu1a5dt3brVpk6dasHBwQF3aGzYsMFCQ0PtkUcesV27dtkLL7xgUVFR9te//tWrefnll23FihX2/vvv26uvvmqdO3e20aNHe/NVVVWWkpJigwcPtvXr19vu3bvt17/+tQUFBdk///nPgJ7eeustk2Q7d+48bd8PPfSQJSUlBZyGB74KDd01duL7uM5VV11lgwcPth07dtjKlSstLS0t4KuxJ5980vx+vy1evNiKiorsoYceMr/fb/369fPWmDNnjrVt29YWLlxoO3futDvvvNPatGlzztcIffTRR5aSkmLXX3+9ffTRR3bw4EFv1CktLbWEhAQbN26cbdu2zfLy8iwqKsqeffZZr2bfvn3Wpk0bu/vuu62oqMhef/11a9++vf3yl7/0aho6lnz++eeWk5Nj+fn5tnfvXtu0aZPdcccd5vP5Au5KRfMhCKFZrV271iTZt7/97YD9n332mY0cOdJat25t7du3t4ceeqjeba8N3T5fVFRk1157rYWHh1v37t1t8eLFzRKEfvWrX9mll15qERER1rZtWxsyZIgtX768Xt1rr71mffr0MZ/PZz179gy4kNLsywN5x44dLSwszJKTk+2hhx4KuNXW7MtfATB69Ghr3769RUVF2RVXXFHvdnozs1tuucWuvvrq0/ZcU1NjHTt2tJ/+9Kdn+aqBs3c2QWjHjh2Wnp5ukZGR1r9/f+/XX9QFoWPHjtntt99u0dHRFhMTYz/+8Y/twQcfDAhC1dXVNnXqVPP7/RYTE2PTp09vltvn58+fb5JOOU7073//26699lrz+Xx2ySWX2Jw5c+qttXbtWhs0aJD5fD7r1q2bPfLII/X+Z+VMx5KKigq78cYbLSkpycLDw61Dhw72ve99j4ulz6MgsxO+tAUAAHAI1wgBAABnEYQAAICzCEIAAMBZBCEAAOAsghAAAHAWQQgAADiLIAQAAJxFEAIAAM4iCAEAAGcRhAAAgLMIQgAAwFn/HxzWmVv9Gw8hAAAAAElFTkSuQmCC\n"
          },
          "metadata": {}
        }
      ],
      "source": [
        "import numpy as np\n",
        "\n",
        "# obtain ground truth from train column\n",
        "is_fruad = train_transaction['isFraud'].values\n",
        "\n",
        "# get counts of fruad and not fruad\n",
        "__num_valid = np.sum(is_fruad == 0)\n",
        "__num_fruad = is_fruad.size - __num_valid\n",
        "\n",
        "plt.bar([0, 1], [__num_valid, __num_fruad], color=['blue', 'red'], tick_label=[f\"Valid - {__num_valid}\", f\"Fruad - {__num_fruad}\"])\n",
        "plt.title('is_fruad')\n",
        "plt.show()"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "Q-6ZTkf8GMdA"
      },
      "source": [
        "## Removal of Features with **too** many missing Values\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 5,
      "metadata": {
        "id": "UrW2mdZ-GZZ9",
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "1b0de578-ab41-47d4-a57a-762a1a5f592e"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Shape of the Training Dataset where features missing over 75.0% of their data were removed: (590540, 182)\n"
          ]
        }
      ],
      "source": [
        "MISSING_TOLERANCE = 0.75 # if missing percent over 75% throw out the feature\n",
        "\n",
        "num_missing_by_feature = train_transaction.isna().sum() / train_transaction.shape[0]\n",
        "features_to_remove = []\n",
        "\n",
        "for feature, percent_missing in num_missing_by_feature.iteritems():\n",
        "  if percent_missing <= 1 - MISSING_TOLERANCE: continue\n",
        "  features_to_remove.append(feature)\n",
        "\n",
        "# drop features that cannot be recovered\n",
        "train_transaction_features_removed = train_transaction.drop(columns=features_to_remove)\n",
        "\n",
        "# show new shape\n",
        "print(f'Shape of the Training Dataset where features missing over {MISSING_TOLERANCE * 100}% of their data were removed: {train_transaction_features_removed.shape}')"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "3Q6GEmYUJp2k"
      },
      "source": [
        "## Filling in missing Values based on Distribution Type"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 6,
      "metadata": {
        "id": "JALHgUoNNDaO",
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "3661c0aa-f71a-49fa-f6cc-dc20df758d0d"
      },
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "TransactionID      0\n",
              "isFraud            0\n",
              "TransactionDT      0\n",
              "TransactionAmt     0\n",
              "ProductCD          0\n",
              "                  ..\n",
              "V317              12\n",
              "V318              12\n",
              "V319              12\n",
              "V320              12\n",
              "V321              12\n",
              "Length: 182, dtype: int64"
            ]
          },
          "metadata": {},
          "execution_count": 6
        }
      ],
      "source": [
        "missing_metadata = train_transaction_features_removed.isna().sum()\n",
        "missing_metadata"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 7,
      "metadata": {
        "id": "NRELP479NUqC",
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "15740968-6c84-4426-ecb4-29f65f6bbd2a"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Feature: \"TransactionID\" is missing 0 values and is_numeric=True\n",
            "Feature: \"isFraud\" is missing 0 values and is_numeric=True\n",
            "Feature: \"TransactionDT\" is missing 0 values and is_numeric=True\n",
            "Feature: \"TransactionAmt\" is missing 0 values and is_numeric=True\n",
            "Feature: \"ProductCD\" is missing 0 values and is_numeric=False\n",
            "Feature: \"card1\" is missing 0 values and is_numeric=True\n",
            "Feature: \"card2\" is missing 8933 values and is_numeric=True\n",
            "Feature: \"card3\" is missing 1565 values and is_numeric=True\n",
            "Feature: \"card4\" is missing 1577 values and is_numeric=False\n",
            "Feature: \"card5\" is missing 4259 values and is_numeric=True\n",
            "Feature: \"card6\" is missing 1571 values and is_numeric=False\n",
            "Feature: \"addr1\" is missing 65706 values and is_numeric=True\n",
            "Feature: \"addr2\" is missing 65706 values and is_numeric=True\n",
            "Feature: \"P_emaildomain\" is missing 94456 values and is_numeric=False\n",
            "Feature: \"C1\" is missing 0 values and is_numeric=True\n",
            "Feature: \"C2\" is missing 0 values and is_numeric=True\n",
            "Feature: \"C3\" is missing 0 values and is_numeric=True\n",
            "Feature: \"C4\" is missing 0 values and is_numeric=True\n",
            "Feature: \"C5\" is missing 0 values and is_numeric=True\n",
            "Feature: \"C6\" is missing 0 values and is_numeric=True\n",
            "Feature: \"C7\" is missing 0 values and is_numeric=True\n",
            "Feature: \"C8\" is missing 0 values and is_numeric=True\n",
            "Feature: \"C9\" is missing 0 values and is_numeric=True\n",
            "Feature: \"C10\" is missing 0 values and is_numeric=True\n",
            "Feature: \"C11\" is missing 0 values and is_numeric=True\n",
            "Feature: \"C12\" is missing 0 values and is_numeric=True\n",
            "Feature: \"C13\" is missing 0 values and is_numeric=True\n",
            "Feature: \"C14\" is missing 0 values and is_numeric=True\n",
            "Feature: \"D1\" is missing 1269 values and is_numeric=True\n",
            "Feature: \"D10\" is missing 76022 values and is_numeric=True\n",
            "Feature: \"D15\" is missing 89113 values and is_numeric=True\n",
            "Feature: \"V12\" is missing 76073 values and is_numeric=True\n",
            "Feature: \"V13\" is missing 76073 values and is_numeric=True\n",
            "Feature: \"V14\" is missing 76073 values and is_numeric=True\n",
            "Feature: \"V15\" is missing 76073 values and is_numeric=True\n",
            "Feature: \"V16\" is missing 76073 values and is_numeric=True\n",
            "Feature: \"V17\" is missing 76073 values and is_numeric=True\n",
            "Feature: \"V18\" is missing 76073 values and is_numeric=True\n",
            "Feature: \"V19\" is missing 76073 values and is_numeric=True\n",
            "Feature: \"V20\" is missing 76073 values and is_numeric=True\n",
            "Feature: \"V21\" is missing 76073 values and is_numeric=True\n",
            "Feature: \"V22\" is missing 76073 values and is_numeric=True\n",
            "Feature: \"V23\" is missing 76073 values and is_numeric=True\n",
            "Feature: \"V24\" is missing 76073 values and is_numeric=True\n",
            "Feature: \"V25\" is missing 76073 values and is_numeric=True\n",
            "Feature: \"V26\" is missing 76073 values and is_numeric=True\n",
            "Feature: \"V27\" is missing 76073 values and is_numeric=True\n",
            "Feature: \"V28\" is missing 76073 values and is_numeric=True\n",
            "Feature: \"V29\" is missing 76073 values and is_numeric=True\n",
            "Feature: \"V30\" is missing 76073 values and is_numeric=True\n",
            "Feature: \"V31\" is missing 76073 values and is_numeric=True\n",
            "Feature: \"V32\" is missing 76073 values and is_numeric=True\n",
            "Feature: \"V33\" is missing 76073 values and is_numeric=True\n",
            "Feature: \"V34\" is missing 76073 values and is_numeric=True\n",
            "Feature: \"V53\" is missing 77096 values and is_numeric=True\n",
            "Feature: \"V54\" is missing 77096 values and is_numeric=True\n",
            "Feature: \"V55\" is missing 77096 values and is_numeric=True\n",
            "Feature: \"V56\" is missing 77096 values and is_numeric=True\n",
            "Feature: \"V57\" is missing 77096 values and is_numeric=True\n",
            "Feature: \"V58\" is missing 77096 values and is_numeric=True\n",
            "Feature: \"V59\" is missing 77096 values and is_numeric=True\n",
            "Feature: \"V60\" is missing 77096 values and is_numeric=True\n",
            "Feature: \"V61\" is missing 77096 values and is_numeric=True\n",
            "Feature: \"V62\" is missing 77096 values and is_numeric=True\n",
            "Feature: \"V63\" is missing 77096 values and is_numeric=True\n",
            "Feature: \"V64\" is missing 77096 values and is_numeric=True\n",
            "Feature: \"V65\" is missing 77096 values and is_numeric=True\n",
            "Feature: \"V66\" is missing 77096 values and is_numeric=True\n",
            "Feature: \"V67\" is missing 77096 values and is_numeric=True\n",
            "Feature: \"V68\" is missing 77096 values and is_numeric=True\n",
            "Feature: \"V69\" is missing 77096 values and is_numeric=True\n",
            "Feature: \"V70\" is missing 77096 values and is_numeric=True\n",
            "Feature: \"V71\" is missing 77096 values and is_numeric=True\n",
            "Feature: \"V72\" is missing 77096 values and is_numeric=True\n",
            "Feature: \"V73\" is missing 77096 values and is_numeric=True\n",
            "Feature: \"V74\" is missing 77096 values and is_numeric=True\n",
            "Feature: \"V75\" is missing 89164 values and is_numeric=True\n",
            "Feature: \"V76\" is missing 89164 values and is_numeric=True\n",
            "Feature: \"V77\" is missing 89164 values and is_numeric=True\n",
            "Feature: \"V78\" is missing 89164 values and is_numeric=True\n",
            "Feature: \"V79\" is missing 89164 values and is_numeric=True\n",
            "Feature: \"V80\" is missing 89164 values and is_numeric=True\n",
            "Feature: \"V81\" is missing 89164 values and is_numeric=True\n",
            "Feature: \"V82\" is missing 89164 values and is_numeric=True\n",
            "Feature: \"V83\" is missing 89164 values and is_numeric=True\n",
            "Feature: \"V84\" is missing 89164 values and is_numeric=True\n",
            "Feature: \"V85\" is missing 89164 values and is_numeric=True\n",
            "Feature: \"V86\" is missing 89164 values and is_numeric=True\n",
            "Feature: \"V87\" is missing 89164 values and is_numeric=True\n",
            "Feature: \"V88\" is missing 89164 values and is_numeric=True\n",
            "Feature: \"V89\" is missing 89164 values and is_numeric=True\n",
            "Feature: \"V90\" is missing 89164 values and is_numeric=True\n",
            "Feature: \"V91\" is missing 89164 values and is_numeric=True\n",
            "Feature: \"V92\" is missing 89164 values and is_numeric=True\n",
            "Feature: \"V93\" is missing 89164 values and is_numeric=True\n",
            "Feature: \"V94\" is missing 89164 values and is_numeric=True\n",
            "Feature: \"V95\" is missing 314 values and is_numeric=True\n",
            "Feature: \"V96\" is missing 314 values and is_numeric=True\n",
            "Feature: \"V97\" is missing 314 values and is_numeric=True\n",
            "Feature: \"V98\" is missing 314 values and is_numeric=True\n",
            "Feature: \"V99\" is missing 314 values and is_numeric=True\n",
            "Feature: \"V100\" is missing 314 values and is_numeric=True\n",
            "Feature: \"V101\" is missing 314 values and is_numeric=True\n",
            "Feature: \"V102\" is missing 314 values and is_numeric=True\n",
            "Feature: \"V103\" is missing 314 values and is_numeric=True\n",
            "Feature: \"V104\" is missing 314 values and is_numeric=True\n",
            "Feature: \"V105\" is missing 314 values and is_numeric=True\n",
            "Feature: \"V106\" is missing 314 values and is_numeric=True\n",
            "Feature: \"V107\" is missing 314 values and is_numeric=True\n",
            "Feature: \"V108\" is missing 314 values and is_numeric=True\n",
            "Feature: \"V109\" is missing 314 values and is_numeric=True\n",
            "Feature: \"V110\" is missing 314 values and is_numeric=True\n",
            "Feature: \"V111\" is missing 314 values and is_numeric=True\n",
            "Feature: \"V112\" is missing 314 values and is_numeric=True\n",
            "Feature: \"V113\" is missing 314 values and is_numeric=True\n",
            "Feature: \"V114\" is missing 314 values and is_numeric=True\n",
            "Feature: \"V115\" is missing 314 values and is_numeric=True\n",
            "Feature: \"V116\" is missing 314 values and is_numeric=True\n",
            "Feature: \"V117\" is missing 314 values and is_numeric=True\n",
            "Feature: \"V118\" is missing 314 values and is_numeric=True\n",
            "Feature: \"V119\" is missing 314 values and is_numeric=True\n",
            "Feature: \"V120\" is missing 314 values and is_numeric=True\n",
            "Feature: \"V121\" is missing 314 values and is_numeric=True\n",
            "Feature: \"V122\" is missing 314 values and is_numeric=True\n",
            "Feature: \"V123\" is missing 314 values and is_numeric=True\n",
            "Feature: \"V124\" is missing 314 values and is_numeric=True\n",
            "Feature: \"V125\" is missing 314 values and is_numeric=True\n",
            "Feature: \"V126\" is missing 314 values and is_numeric=True\n",
            "Feature: \"V127\" is missing 314 values and is_numeric=True\n",
            "Feature: \"V128\" is missing 314 values and is_numeric=True\n",
            "Feature: \"V129\" is missing 314 values and is_numeric=True\n",
            "Feature: \"V130\" is missing 314 values and is_numeric=True\n",
            "Feature: \"V131\" is missing 314 values and is_numeric=True\n",
            "Feature: \"V132\" is missing 314 values and is_numeric=True\n",
            "Feature: \"V133\" is missing 314 values and is_numeric=True\n",
            "Feature: \"V134\" is missing 314 values and is_numeric=True\n",
            "Feature: \"V135\" is missing 314 values and is_numeric=True\n",
            "Feature: \"V136\" is missing 314 values and is_numeric=True\n",
            "Feature: \"V137\" is missing 314 values and is_numeric=True\n",
            "Feature: \"V279\" is missing 12 values and is_numeric=True\n",
            "Feature: \"V280\" is missing 12 values and is_numeric=True\n",
            "Feature: \"V281\" is missing 1269 values and is_numeric=True\n",
            "Feature: \"V282\" is missing 1269 values and is_numeric=True\n",
            "Feature: \"V283\" is missing 1269 values and is_numeric=True\n",
            "Feature: \"V284\" is missing 12 values and is_numeric=True\n",
            "Feature: \"V285\" is missing 12 values and is_numeric=True\n",
            "Feature: \"V286\" is missing 12 values and is_numeric=True\n",
            "Feature: \"V287\" is missing 12 values and is_numeric=True\n",
            "Feature: \"V288\" is missing 1269 values and is_numeric=True\n",
            "Feature: \"V289\" is missing 1269 values and is_numeric=True\n",
            "Feature: \"V290\" is missing 12 values and is_numeric=True\n",
            "Feature: \"V291\" is missing 12 values and is_numeric=True\n",
            "Feature: \"V292\" is missing 12 values and is_numeric=True\n",
            "Feature: \"V293\" is missing 12 values and is_numeric=True\n",
            "Feature: \"V294\" is missing 12 values and is_numeric=True\n",
            "Feature: \"V295\" is missing 12 values and is_numeric=True\n",
            "Feature: \"V296\" is missing 1269 values and is_numeric=True\n",
            "Feature: \"V297\" is missing 12 values and is_numeric=True\n",
            "Feature: \"V298\" is missing 12 values and is_numeric=True\n",
            "Feature: \"V299\" is missing 12 values and is_numeric=True\n",
            "Feature: \"V300\" is missing 1269 values and is_numeric=True\n",
            "Feature: \"V301\" is missing 1269 values and is_numeric=True\n",
            "Feature: \"V302\" is missing 12 values and is_numeric=True\n",
            "Feature: \"V303\" is missing 12 values and is_numeric=True\n",
            "Feature: \"V304\" is missing 12 values and is_numeric=True\n",
            "Feature: \"V305\" is missing 12 values and is_numeric=True\n",
            "Feature: \"V306\" is missing 12 values and is_numeric=True\n",
            "Feature: \"V307\" is missing 12 values and is_numeric=True\n",
            "Feature: \"V308\" is missing 12 values and is_numeric=True\n",
            "Feature: \"V309\" is missing 12 values and is_numeric=True\n",
            "Feature: \"V310\" is missing 12 values and is_numeric=True\n",
            "Feature: \"V311\" is missing 12 values and is_numeric=True\n",
            "Feature: \"V312\" is missing 12 values and is_numeric=True\n",
            "Feature: \"V313\" is missing 1269 values and is_numeric=True\n",
            "Feature: \"V314\" is missing 1269 values and is_numeric=True\n",
            "Feature: \"V315\" is missing 1269 values and is_numeric=True\n",
            "Feature: \"V316\" is missing 12 values and is_numeric=True\n",
            "Feature: \"V317\" is missing 12 values and is_numeric=True\n",
            "Feature: \"V318\" is missing 12 values and is_numeric=True\n",
            "Feature: \"V319\" is missing 12 values and is_numeric=True\n",
            "Feature: \"V320\" is missing 12 values and is_numeric=True\n",
            "Feature: \"V321\" is missing 12 values and is_numeric=True\n"
          ]
        }
      ],
      "source": [
        "import numpy as np\n",
        "\n",
        "for feature, num_missing in missing_metadata.items():\n",
        "  # numpy array of data that is present\n",
        "  feature_data = train_transaction_features_removed[feature].values\n",
        "  \n",
        "  # check if array is numeric\n",
        "  is_numeric = np.issubdtype(feature_data.dtype, np.number)\n",
        "\n",
        "  print(f'Feature: \"{feature}\" is missing {num_missing} values and is_numeric={is_numeric}')                                            "
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "MGR3fJo6IGh1"
      },
      "source": [
        "## Shift Categorical Features to Numerical without touching `NaN` values\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 8,
      "metadata": {
        "id": "miDXyHEiIZTv"
      },
      "outputs": [],
      "source": [
        "from sklearn.preprocessing import LabelEncoder\n",
        "\n",
        "def label_encode_categorical(df):\n",
        "    \"\"\"\n",
        "    Encodes all categorical features in a DataFrame using LabelEncoder.\n",
        "    \"\"\"\n",
        "    # encoder\n",
        "    le = LabelEncoder()\n",
        "\n",
        "    # save all values we shifted\n",
        "    replaced = []\n",
        "    for col in df.columns:\n",
        "        if df[col].dtype == 'object':\n",
        "\n",
        "            replaced.append(col)\n",
        "\n",
        "            # fill NaN values with a placeholder value before encoding\n",
        "            df[col] = df[col].fillna('N/A')\n",
        "\n",
        "            # fit with data and cast\n",
        "            df[col] = le.fit_transform(df[col])\n",
        "\n",
        "            # restore NaN values if they were ever present\n",
        "            if missing_metadata[col] > 0:\n",
        "              df[col] = df[col].where(df[col] != le.transform(['N/A'])[0], np.nan)\n",
        "\n",
        "    return df, replaced\n",
        "\n",
        "train_transaction_features_removed_all_numerical_with_nan, replaced = label_encode_categorical(train_transaction_features_removed)"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "6FtsHoSxQcTq"
      },
      "source": [
        "## Fill in Missing Values using Mean/Mode/Median values"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 9,
      "metadata": {
        "id": "tGXq2TRrQj0j"
      },
      "outputs": [],
      "source": [
        "from sklearn.preprocessing import StandardScaler\n",
        "from scipy.stats import skew as scipy_skew\n",
        "from numpy import mean, median\n",
        "\n",
        "SKEW_TOLERANCE = 0.5\n",
        "\n",
        "def apply_numerical_scaler_to_frame(df: pd.DataFrame, Scaler, features_to_ignore):\n",
        "\n",
        "  # only scale those features we didnt ignore and have missing features\n",
        "  features_to_scale = [feature for feature, num_missing in missing_metadata.items() if feature not in features_to_ignore and num_missing > 0]\n",
        "\n",
        "\n",
        "  # replacement history\n",
        "  replacement_history = {}\n",
        "\n",
        "  for col in features_to_scale:\n",
        "    # get all values they arent null from $col\n",
        "    values = df[col].values\n",
        "    non_nan_values = values[~np.isnan(values)]\n",
        "\n",
        "    # obtain skew\n",
        "    abs_skew = np.abs(scipy_skew(non_nan_values))\n",
        "\n",
        "    # choose which function to apply to find a good replacement\n",
        "    replacer = median if abs_skew >= SKEW_TOLERANCE else mean\n",
        "\n",
        "    # calc replace value\n",
        "    replace_val = replacer(non_nan_values)\n",
        "\n",
        "    # record replacement value for test\n",
        "    replacement_history[col] = replace_val\n",
        "\n",
        "    # apply it\n",
        "    df[col].replace({np.nan: replace_val}, inplace=True)\n",
        "\n",
        "\n",
        "  return df, replacement_history\n",
        "\n",
        "# swappable scaler\n",
        "Scaler = StandardScaler()\n",
        "\n",
        "# scale all features\n",
        "features_to_ignore = replaced\n",
        "train_transaction_features_removed_all_numerical_no_num_nan, replacement_history = apply_numerical_scaler_to_frame(train_transaction_features_removed_all_numerical_with_nan, \n",
        "                                                                                          Scaler, \n",
        "                                                                                          features_to_ignore)"
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "train_transaction_features_removed_all_numerical_no_num_nan"
      ],
      "metadata": {
        "id": "0IswIHdbKHQT",
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 488
        },
        "outputId": "c0e55cb0-23a3-4945-b90b-6c9d4e1e2a0e"
      },
      "execution_count": 10,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "        TransactionID  isFraud  TransactionDT  TransactionAmt  ProductCD  \\\n",
              "0             2987000        0          86400           68.50          4   \n",
              "1             2987001        0          86401           29.00          4   \n",
              "2             2987002        0          86469           59.00          4   \n",
              "3             2987003        0          86499           50.00          4   \n",
              "4             2987004        0          86506           50.00          1   \n",
              "...               ...      ...            ...             ...        ...   \n",
              "590535        3577535        0       15811047           49.00          4   \n",
              "590536        3577536        0       15811049           39.50          4   \n",
              "590537        3577537        0       15811079           30.95          4   \n",
              "590538        3577538        0       15811088          117.00          4   \n",
              "590539        3577539        0       15811131          279.95          4   \n",
              "\n",
              "        card1       card2  card3  card4  card5  ...   V312        V313  \\\n",
              "0       13926  362.555488  150.0    2.0  142.0  ...    0.0    0.000000   \n",
              "1        2755  404.000000  150.0    3.0  102.0  ...    0.0    0.000000   \n",
              "2        4663  490.000000  150.0    4.0  166.0  ...    0.0    0.000000   \n",
              "3       18132  567.000000  150.0    3.0  117.0  ...  135.0    0.000000   \n",
              "4        4497  514.000000  150.0    3.0  102.0  ...    0.0    0.000000   \n",
              "...       ...         ...    ...    ...    ...  ...    ...         ...   \n",
              "590535   6550  362.555488  150.0    4.0  226.0  ...    0.0   47.950001   \n",
              "590536  10444  225.000000  150.0    3.0  224.0  ...    0.0    0.000000   \n",
              "590537  12037  595.000000  150.0    3.0  224.0  ...    0.0    0.000000   \n",
              "590538   7826  481.000000  150.0    3.0  224.0  ...  117.0  317.500000   \n",
              "590539  15066  170.000000  150.0    3.0  102.0  ...    0.0    0.000000   \n",
              "\n",
              "              V314        V315  V316    V317   V318        V319        V320  \\\n",
              "0         0.000000    0.000000   0.0   117.0    0.0    0.000000    0.000000   \n",
              "1         0.000000    0.000000   0.0     0.0    0.0    0.000000    0.000000   \n",
              "2         0.000000    0.000000   0.0     0.0    0.0    0.000000    0.000000   \n",
              "3         0.000000    0.000000  50.0  1404.0  790.0    0.000000    0.000000   \n",
              "4         0.000000    0.000000   0.0     0.0    0.0    0.000000    0.000000   \n",
              "...            ...         ...   ...     ...    ...         ...         ...   \n",
              "590535   47.950001   47.950001   0.0     0.0    0.0    0.000000    0.000000   \n",
              "590536    0.000000    0.000000   0.0     0.0    0.0    0.000000    0.000000   \n",
              "590537    0.000000    0.000000   0.0     0.0    0.0    0.000000    0.000000   \n",
              "590538  669.500000  317.500000   0.0  2234.0    0.0    0.000000    0.000000   \n",
              "590539    0.000000    0.000000   0.0     0.0    0.0  279.950012  279.950012   \n",
              "\n",
              "              V321  \n",
              "0         0.000000  \n",
              "1         0.000000  \n",
              "2         0.000000  \n",
              "3         0.000000  \n",
              "4         0.000000  \n",
              "...            ...  \n",
              "590535    0.000000  \n",
              "590536    0.000000  \n",
              "590537    0.000000  \n",
              "590538    0.000000  \n",
              "590539  279.950012  \n",
              "\n",
              "[590540 rows x 182 columns]"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-a338716c-bce6-4899-8562-af80605c1e93\">\n",
              "    <div class=\"colab-df-container\">\n",
              "      <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>TransactionID</th>\n",
              "      <th>isFraud</th>\n",
              "      <th>TransactionDT</th>\n",
              "      <th>TransactionAmt</th>\n",
              "      <th>ProductCD</th>\n",
              "      <th>card1</th>\n",
              "      <th>card2</th>\n",
              "      <th>card3</th>\n",
              "      <th>card4</th>\n",
              "      <th>card5</th>\n",
              "      <th>...</th>\n",
              "      <th>V312</th>\n",
              "      <th>V313</th>\n",
              "      <th>V314</th>\n",
              "      <th>V315</th>\n",
              "      <th>V316</th>\n",
              "      <th>V317</th>\n",
              "      <th>V318</th>\n",
              "      <th>V319</th>\n",
              "      <th>V320</th>\n",
              "      <th>V321</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>2987000</td>\n",
              "      <td>0</td>\n",
              "      <td>86400</td>\n",
              "      <td>68.50</td>\n",
              "      <td>4</td>\n",
              "      <td>13926</td>\n",
              "      <td>362.555488</td>\n",
              "      <td>150.0</td>\n",
              "      <td>2.0</td>\n",
              "      <td>142.0</td>\n",
              "      <td>...</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.0</td>\n",
              "      <td>117.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>2987001</td>\n",
              "      <td>0</td>\n",
              "      <td>86401</td>\n",
              "      <td>29.00</td>\n",
              "      <td>4</td>\n",
              "      <td>2755</td>\n",
              "      <td>404.000000</td>\n",
              "      <td>150.0</td>\n",
              "      <td>3.0</td>\n",
              "      <td>102.0</td>\n",
              "      <td>...</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>2987002</td>\n",
              "      <td>0</td>\n",
              "      <td>86469</td>\n",
              "      <td>59.00</td>\n",
              "      <td>4</td>\n",
              "      <td>4663</td>\n",
              "      <td>490.000000</td>\n",
              "      <td>150.0</td>\n",
              "      <td>4.0</td>\n",
              "      <td>166.0</td>\n",
              "      <td>...</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>2987003</td>\n",
              "      <td>0</td>\n",
              "      <td>86499</td>\n",
              "      <td>50.00</td>\n",
              "      <td>4</td>\n",
              "      <td>18132</td>\n",
              "      <td>567.000000</td>\n",
              "      <td>150.0</td>\n",
              "      <td>3.0</td>\n",
              "      <td>117.0</td>\n",
              "      <td>...</td>\n",
              "      <td>135.0</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>50.0</td>\n",
              "      <td>1404.0</td>\n",
              "      <td>790.0</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>2987004</td>\n",
              "      <td>0</td>\n",
              "      <td>86506</td>\n",
              "      <td>50.00</td>\n",
              "      <td>1</td>\n",
              "      <td>4497</td>\n",
              "      <td>514.000000</td>\n",
              "      <td>150.0</td>\n",
              "      <td>3.0</td>\n",
              "      <td>102.0</td>\n",
              "      <td>...</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>590535</th>\n",
              "      <td>3577535</td>\n",
              "      <td>0</td>\n",
              "      <td>15811047</td>\n",
              "      <td>49.00</td>\n",
              "      <td>4</td>\n",
              "      <td>6550</td>\n",
              "      <td>362.555488</td>\n",
              "      <td>150.0</td>\n",
              "      <td>4.0</td>\n",
              "      <td>226.0</td>\n",
              "      <td>...</td>\n",
              "      <td>0.0</td>\n",
              "      <td>47.950001</td>\n",
              "      <td>47.950001</td>\n",
              "      <td>47.950001</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>590536</th>\n",
              "      <td>3577536</td>\n",
              "      <td>0</td>\n",
              "      <td>15811049</td>\n",
              "      <td>39.50</td>\n",
              "      <td>4</td>\n",
              "      <td>10444</td>\n",
              "      <td>225.000000</td>\n",
              "      <td>150.0</td>\n",
              "      <td>3.0</td>\n",
              "      <td>224.0</td>\n",
              "      <td>...</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>590537</th>\n",
              "      <td>3577537</td>\n",
              "      <td>0</td>\n",
              "      <td>15811079</td>\n",
              "      <td>30.95</td>\n",
              "      <td>4</td>\n",
              "      <td>12037</td>\n",
              "      <td>595.000000</td>\n",
              "      <td>150.0</td>\n",
              "      <td>3.0</td>\n",
              "      <td>224.0</td>\n",
              "      <td>...</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>590538</th>\n",
              "      <td>3577538</td>\n",
              "      <td>0</td>\n",
              "      <td>15811088</td>\n",
              "      <td>117.00</td>\n",
              "      <td>4</td>\n",
              "      <td>7826</td>\n",
              "      <td>481.000000</td>\n",
              "      <td>150.0</td>\n",
              "      <td>3.0</td>\n",
              "      <td>224.0</td>\n",
              "      <td>...</td>\n",
              "      <td>117.0</td>\n",
              "      <td>317.500000</td>\n",
              "      <td>669.500000</td>\n",
              "      <td>317.500000</td>\n",
              "      <td>0.0</td>\n",
              "      <td>2234.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>590539</th>\n",
              "      <td>3577539</td>\n",
              "      <td>0</td>\n",
              "      <td>15811131</td>\n",
              "      <td>279.95</td>\n",
              "      <td>4</td>\n",
              "      <td>15066</td>\n",
              "      <td>170.000000</td>\n",
              "      <td>150.0</td>\n",
              "      <td>3.0</td>\n",
              "      <td>102.0</td>\n",
              "      <td>...</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.000000</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>0.0</td>\n",
              "      <td>279.950012</td>\n",
              "      <td>279.950012</td>\n",
              "      <td>279.950012</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>590540 rows Ã— 182 columns</p>\n",
              "</div>\n",
              "      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-a338716c-bce6-4899-8562-af80605c1e93')\"\n",
              "              title=\"Convert this dataframe to an interactive table.\"\n",
              "              style=\"display:none;\">\n",
              "        \n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n",
              "    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n",
              "  </svg>\n",
              "      </button>\n",
              "      \n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      flex-wrap:wrap;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "      <script>\n",
              "        const buttonEl =\n",
              "          document.querySelector('#df-a338716c-bce6-4899-8562-af80605c1e93 button.colab-df-convert');\n",
              "        buttonEl.style.display =\n",
              "          google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "        async function convertToInteractive(key) {\n",
              "          const element = document.querySelector('#df-a338716c-bce6-4899-8562-af80605c1e93');\n",
              "          const dataTable =\n",
              "            await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                     [key], {});\n",
              "          if (!dataTable) return;\n",
              "\n",
              "          const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "            + ' to learn more about interactive tables.';\n",
              "          element.innerHTML = '';\n",
              "          dataTable['output_type'] = 'display_data';\n",
              "          await google.colab.output.renderOutput(dataTable, element);\n",
              "          const docLink = document.createElement('div');\n",
              "          docLink.innerHTML = docLinkHtml;\n",
              "          element.appendChild(docLink);\n",
              "        }\n",
              "      </script>\n",
              "    </div>\n",
              "  </div>\n",
              "  "
            ]
          },
          "metadata": {},
          "execution_count": 10
        }
      ]
    }
  ],
  "metadata": {
    "colab": {
      "provenance": [],
      "machine_shape": "hm"
    },
    "kernelspec": {
      "display_name": "Python 3",
      "name": "python3"
    },
    "language_info": {
      "name": "python"
    },
    "gpuClass": "standard"
  },
  "nbformat": 4,
  "nbformat_minor": 0
}