# Network Vulnerability Analysis

| Chosen Protocol | Port & Transport Protocol | CVE  | Severity Rating  |
| --------------- | ------------------------- | ---- | -------------------- |
| **ICMP**        | general/tcp               | NONE | LOW                  | 

## Vulnerability
A threat actor has the option to discover all the machines on the network with an ARP or a Ping sweep. This is done by ARP-ing pining each possible address on a network. While this is a direct vulnerability it can be used for discovery. I think CVE has given it a low severity rating because it does not give an attack an objective or an entry point. It only provides surface level knowledge. 

One way a ping sweep can be done is `nmap`. Here is an example of `nmap` scanning an entire block of class C addresses:
```unix
nmap -sP 192.168.47.0-255
```

I assume this is what was ran on the `pcap` file I have attached. The attached `pcap` is not my own recording, it is a capture found online. 

![ping_sweep](/img/ping_sweep.png)

Current we are sending out a **`TYPE 8`** echo request and we expect a **`TYPE 0`** reply to confirm a machine is alive. 

Internet Control Message Protocol (ICMP) has **no port**. This is because it is a layer 3 protocol, this means it is implemented as part of the IP layer. Since layer 3 devices have no ports (we can ignore NAT devices), they cannot be addressed by `IP:PORT` addressing. Instead ICMP works with types. Based on the message type a layer three device will respond (or not based on how it is configured).

## The Capture
Packet View:
![ping_sweep](/img/ping_sweep.png)

Meta data:
![ping_sweep_meta](/img/ping_sweep_meta.png)

The capture is quite trivial since it does not contain any company information like login or any revealing information. Evidence for this is also easy to find. Since an ICMP packet will travel though layer 3 devices they can be used to detect and alert if someone is using ICMP on the network as it is usually disabled. Moreover it can be easy to catch someone pinging IP blocks if we are *already* monitoring network traffic.  







<!--## Vulnerability \& Risk

Vulnerability: *DNS amplification attack*

This is quite similar to DDoS. In DNS amplification attacks an attacker sends a DNS request to a public DNS server but spoofs their IP to be their victims IP. When the DNS server completes the request (via cache or hierarchical nameserver querying) it will reply to the **spoofed** IP address which will send DNS packets to to the victim. 

See that this is made worse on the UDP protocol as UDP has no flow or congestion control and the attacker can flood the network without having to bypass TCP flow/congestion control. 

- Flow Control - Transfer speed throttling based on the size of the receiver window
- Congestion Control - Transfer speed throttling based on the congestion on the current network

This type of *Denial of Service* attack is listed under CVE-2016-6170 and has a severity rating $\mathbf{4.0}/10$. 
-->

